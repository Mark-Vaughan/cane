function testTransientNitscheWeakDBCPlateMembraneAnalysis(testCase)
%% Licensing
%
% License:         BSD License
%                  cane Multiphysics default license: cane/license.txt
%
% Main authors:    Andreas Apostolatos
%
%% Function documentation
%
% Tests the Nitsche method for the application of weak Dirichlet boundary
% conditions in the case of a single-patch semispherical membrane subject
% to its self-weight, constant internal pressure and a dirac point load
% released in the dynamic analysis.
% 
% Function layout :
%
% 0. Read input
%
% 1. Define the multipatch geometry in terms of NURBS
%
% 2. Define the material parameters
%
% 3. GUI
%
% 4. Define the refinement
%
% 5. Get the parametric location of the point load application
%
% 6. Dirichlet and Neumann boundary conditions
%
% 7. Create the patch cell array
%
% 8. Define the expected solutions
%
% 9. Define the nonlinear analysis parameters
%
% 10. Define transient analysis properties
%
% 11. Solve the transient nonlinear problem
%
% 12. Verify the solution
%
%% Function main body

%% 0. Read input

% Define absolute tolerance
absTol = 1e-13;

%% 1. Define the multipatch geometry in terms of NURBS

% Polynomial degrees
p = 2;
q = 2;

% Knot vectors
Xi = [                 0
                       0
                       0
       0.166666666666667
       0.333333333333333
       0.500000000000000
       0.666666666666667
       0.833333333333333
       1.000000000000000
       1.000000000000000
       1.000000000000000]';
Eta = [                    0
                           0
                           0
           0.166666666666667
           0.333333333333333
           0.500000000000000
           0.666666666666667
           0.833333333333333
           1.000000000000000
           1.000000000000000
           1.000000000000000]';

% Control Point coordinates

% x-coordinates
CP(:,:,1) = [ -0.053033008588991  -0.046462253662236  -0.029925055443628  -0.010355339059327   0.010355339059327   0.029925055443628   0.046462253662236   0.053033008588991
              -0.059603763515746  -0.053789986622097  -0.036276226691635  -0.012844490465199   0.012844490465199   0.036276226691635   0.053789986622097   0.059603763515746
              -0.069490949413548  -0.066682578181259  -0.051389330312926  -0.020247145899842   0.020247145899842   0.051389330312926   0.066682578181259   0.069490949413548
              -0.075000000000000  -0.074503727235714  -0.064231111694526  -0.028100604679647   0.028100604679647   0.064231111694526   0.074503727235714   0.075000000000000
              -0.075000000000000  -0.074503727235714  -0.064231111694526  -0.028100604679647   0.028100604679647   0.064231111694526   0.074503727235714   0.075000000000000
              -0.069490949413548  -0.066682578181259  -0.051389330312926  -0.020247145899842   0.020247145899842   0.051389330312926   0.066682578181259   0.069490949413548
              -0.059603763515746  -0.053789986622097  -0.036276226691635  -0.012844490465199   0.012844490465199   0.036276226691635   0.053789986622097   0.059603763515746
              -0.053033008588991  -0.046462253662236  -0.029925055443628  -0.010355339059327   0.010355339059327   0.029925055443628   0.046462253662236   0.053033008588991];
         
% y-coordinates
CP(:,:,2) = [ -0.053033008588991  -0.059603763515746  -0.069490949413548  -0.075000000000000  -0.075000000000000  -0.069490949413548  -0.059603763515746  -0.053033008588991
              -0.046462253662236  -0.053789986622097  -0.066682578181258  -0.074503727235714  -0.074503727235714  -0.066682578181259  -0.053789986622097  -0.046462253662236
              -0.029925055443628  -0.036276226691635  -0.051389330312926  -0.064231111694526  -0.064231111694526  -0.051389330312926  -0.036276226691635  -0.029925055443628
              -0.010355339059327  -0.012844490465199  -0.020247145899842  -0.028100604679647  -0.028100604679647  -0.020247145899842  -0.012844490465199  -0.010355339059327
               0.010355339059327   0.012844490465199   0.020247145899842   0.028100604679647   0.028100604679647   0.020247145899842   0.012844490465199   0.010355339059327
               0.029925055443628   0.036276226691635   0.051389330312926   0.064231111694526   0.064231111694526   0.051389330312926   0.036276226691635   0.029925055443628
               0.046462253662236   0.053789986622097   0.066682578181259   0.074503727235714   0.074503727235714   0.066682578181259   0.053789986622097   0.046462253662236
               0.053033008588991   0.059603763515746   0.069490949413548   0.075000000000000   0.075000000000000   0.069490949413548   0.059603763515746   0.053033008588991];
         
% z-coordinates
CP(:,:,3) = [  0                   0                   0                   0                   0                   0                   0                   0
               0   0.002387453409876   0.006672660956309   0.009117179053618   0.009117179053618   0.006672660956309   0.002387453409876                   0
               0   0.006672660956309   0.023450643108123   0.037341851315138   0.037341851315138   0.023450643108123   0.006672660956309                   0
               0   0.009117179053618   0.037341851315138   0.067672292986537   0.067672292986537   0.037341851315138   0.009117179053618                   0
               0   0.009117179053618   0.037341851315138   0.067672292986537   0.067672292986537   0.037341851315138   0.009117179053618                   0
               0   0.006672660956309   0.023450643108123   0.037341851315138   0.037341851315138   0.023450643108123   0.006672660956309                   0
               0   0.002387453409876   0.006672660956309   0.009117179053618   0.009117179053618   0.006672660956309   0.002387453409876                   0
               0                   0                   0                   0                   0                   0                   0                   0];
       
% Weights
CP(:,:,4) = [  1.000000000000000   0.951184463531091   0.886097081572546   0.853553390593274   0.853553390593274   0.886097081572546   0.951184463531091   1.000000000000000
               0.951184463531091   0.904751883662930   0.842841777172048   0.811886723926607   0.811886723926607   0.842841777172048   0.904751883662930   0.951184463531091
               0.886097081572546   0.842841777172048   0.785168037971384   0.756331168371052   0.756331168371052   0.785168037971384   0.842841777172048   0.886097081572546
               0.853553390593274   0.811886723926607   0.756331168371052   0.728553390593274   0.728553390593274   0.756331168371052   0.811886723926607   0.853553390593274
               0.853553390593274   0.811886723926607   0.756331168371052   0.728553390593274   0.728553390593274   0.756331168371052   0.811886723926607   0.853553390593274
               0.886097081572546   0.842841777172048   0.785168037971384   0.756331168371052   0.756331168371052   0.785168037971384   0.842841777172048   0.886097081572546
               0.951184463531091   0.904751883662930   0.842841777172048   0.811886723926607   0.811886723926607   0.842841777172048   0.904751883662930   0.951184463531091
               1.000000000000000   0.951184463531091   0.886097081572546   0.853553390593274   0.853553390593274   0.886097081572546   0.951184463531091   1.000000000000000];

% Find whether the geometrical basis is a NURBS or a B-Spline
isNURBS = 0;
nxi = length(CP(:,1,1));
neta = length(CP(1,:,1));
for i = 1:nxi
    for j = 1:neta
        if CP(i,j,4) ~= 1
            isNURBS = 1;
            break;
        end
    end
    if isNURBS
        break;
    end
end

%% 2. Define the material parameters

% Young's modulus
parameters.E = 7.e5;

% Poisson ratio
parameters.nue = 0.49;

% Thickness of the shell
parameters.t = 1.65e-4;

% Density of the shell (used only for dynamics)
parameters.rho = 1050;

% Prestress for the membrane
parameters.prestress.computeParametricCoordinates = @(X) [X(1,1)^2 + X(2,1)^2
                                                          atan(X(2,1)/X(1,1))];
parameters.prestress.computeBaseVectors = @(theta1,theta2) [ cos(theta2) -sin(theta2)
                                                             sin(theta2) cos(theta2)
                                                             0           0];
parameters.prestress.voigtVector = [7794.5
                                    7794.5
                                    0];

%% 3. GUI

% Analysis type
analysis.type = 'isogeometricMembraneAnalysis';

% Case name
caseName = 'transientSemisphere';

% Define linear equation system solver
solve_LinearSystem = @solve_LinearSystemMatlabBackslashSolver;

% Co-simulation with EMPIRE
propEmpireCoSimulation.isCoSimulation = false; % Flag on whether co-simulation with EMPIRE is assumed
propEmpireCoSimulation.isInterfaceLayer = false; % Flag on whether the matlab client is used as an interface layer
propEmpireCoSimulation.strMatlabXml = 'undefined'; % Name of the xml file for Matlab

% Integration scheme
% type = 'default' : default FGI integration element-wise
% type = 'manual' : manual choice of the number of Gauss points
int.type = 'default';
if strcmp(int.type,'user')
    int.xiNGP = 6;
    int.etaNGP = 6;
    int.xiNGPForLoad = 6;
    int.xetaNGPForLoad = 6;
end

% Function handle to writing out the results
propOutput = 'undefined';

% Postprocessing
propPostproc.resultant = {'displacement'};
propPostproc.computeResultant = {'computeDisplacement'};

%% 4. Define the refinement

% Degree by which to elevate
a = 0;
tp = a;
tq = a;
[Xi,Eta,CP,p,q] = degreeElevateBSplineSurface(p,q,Xi,Eta,CP,tp,tq,'');

% Number of knots to exist in both directions
scaling = 0;
refXi = scaling;
refEta = scaling;
[Xi,Eta,CP] = knotRefineUniformlyBSplineSurface(p,Xi,q,Eta,CP,refXi,refEta,'');

%% 5. Get the parametric location of the point load application
Radius = norm(squeeze(CP(end,1,1:3)));
xi0 = .5;
eta0 = .5;
P = Radius/sqrt(2)*[1; 1; 1];
propNewtonRaphson.eps = 1e-15;
propNewtonRaphson.maxIt = 1000;
[xiP,etaP,~,isProjected,~] = ...
    computeNearestPointProjectionOnBSplineSurface...
    (P,p,Xi,q,Eta,CP,isNURBS,xi0,eta0,propNewtonRaphson);
if ~isProjected
    error('The point of the load application could not be found on patch 2');
end

%% 6. Dirichlet and Neumann boundary conditions

% Homogeneous Dirichlet boundary conditions
homDOFs = [];

% Inhomogeneous Dirichlet boundary conditions
inhomDOFs = [];
valuesInhomDOFs = [];

% Weak Dirichlet boundary conditions
weakDBC.noCnd = 4;
weakDBC.method = 'nitsche';
weakDBC.estimationStabilPrm = true;
weakDBC.xiExtension = {[0 0] [0 1] [1 1] [0 1]};
weakDBC.etaExtension = {[0 1] [0 0] [0 1] [1 1]};
weakDBC.int.type = 'default';
weakDBC.int.noGPs = 16;

% Embedded cables
cables.No = 0;

% Pressure Load amplitude
FAmpPressure = - 43.2;
FAmpWeight = - 9.81*parameters.rho*parameters.t;
scaling = 10;
FPointLoad = .018;
FAmpPoint = @(x,y,z,t)scaling*FPointLoad*(t<0.001);

% load (Neuman boundary conditions)
% FAmp = 0;
xib1 = [0 1];   etab1 = [0 1];   dirForcePressure = 'normal';
xib2 = [0 1];   etab2 = [0 1];   dirForceWeight = 'z';
xiP2 = xiP;    etaP2 = etaP; dirForcePoint = 'normal';
NBC.noCnd = 3;
NBC.xiLoadExtension = {xib1 xib2 xiP2};
NBC.etaLoadExtension = {etab1 etab2 etaP2};
NBC.loadAmplitude = {FAmpPressure FAmpWeight FAmpPoint};
NBC.loadDirection = {dirForcePressure dirForceWeight dirForcePoint};
NBC.computeLoadVct = {'computeLoadVctAreaIGAThinStructure' 'computeLoadVctAreaIGAThinStructure' 'computeLoadVctPointIGAThinStructure'};
NBC.isFollower = [true; false; false];
NBC.isTimeDependent = [false; false; false];

%% 7. Create the patch cell array
BSplinePatch = fillUpPatch...
    (analysis,p,Xi,q,Eta,CP,isNURBS,parameters,homDOFs,inhomDOFs,...
    valuesInhomDOFs,weakDBC,cables,NBC,[],[],[],[],[],int);
BSplinePatches = {BSplinePatch};

%% 8. Define the expected solutions

% Define the expected solution for the Penalty method in terms of the
% Control Point displacements
expSolDispHistory = [      0   0.000000000080613   0.000000000160451   0.000000000253856   0.000000000283155   0.000000000183040   0.000000000122021   0.000000000295764   0.000000000340766   0.000000000099484   0.000000000221281   0.000000000341814
                           0   0.000000000080370   0.000000000159705   0.000000000252558   0.000000000282390   0.000000000182301   0.000000000120971   0.000000000295001   0.000000000339812   0.000000000098588   0.000000000220205   0.000000000341112
                           0  -0.000000000726020  -0.000000000274576   0.000000000823389   0.000000001198203   0.000000000030754  -0.000000000673209   0.000000001200028   0.000000001361599  -0.000000000829183   0.000000000189014   0.000000001480657
                           0  -0.000000000067547   0.000000000237030   0.000000000734006   0.000000000777874   0.000000000299498   0.000000000218833   0.000000000816466   0.000000000789599   0.000000000194547   0.000000000486940   0.000000000842259
                           0   0.000000000605371   0.000000000261765   0.000000000145627   0.000000000228147   0.000000000047707   0.000000000539356  -0.000000000000767  -0.000000000033863   0.000000000623517  -0.000000000200850   0.000000000425138
                           0  -0.000000000874065  -0.000000000657704   0.000000001192631   0.000000001643431  -0.000000000218666  -0.000000000880092   0.000000001126133   0.000000002312455  -0.000000001523295  -0.000000000405027   0.000000003134456
                           0   0.000000000273748   0.000000000363502   0.000000000924535   0.000000001060741   0.000000000193182   0.000000000620827   0.000000001031920   0.000000000582037   0.000000000681260   0.000000000434500   0.000000000970424
                           0  -0.000000000023581   0.000000000150070  -0.000000000257374  -0.000000000350624   0.000000000455008  -0.000000000330916  -0.000000000284590   0.000000000470575  -0.000000000610950   0.000000000336984  -0.000000000025221
                           0  -0.000000000845015  -0.000000000220079   0.000000002117645   0.000000002915343  -0.000000000490908   0.000000000117660   0.000000003036198   0.000000001346897   0.000000000733510  -0.000000000099679   0.000000002547530
                           0  -0.000000000191411   0.000000000255948   0.000000000940161   0.000000000687749   0.000000000356665   0.000000000501591   0.000000000583050   0.000000000960408   0.000000000393462   0.000000000246455   0.000000001225208
                           0   0.000000000609797   0.000000000239129  -0.000000000212126   0.000000000206280   0.000000000033241  -0.000000000068975   0.000000000481870  -0.000000000518629   0.000000000344088   0.000000000539017  -0.000000000964099
                           0  -0.000000001400061   0.000000000069283   0.000000003469648   0.000000002623384   0.000000000647663   0.000000001239856   0.000000001738079   0.000000004053783  -0.000000000246575   0.000000000023893   0.000000005687566
                           0   0.000000000578763   0.000000000420550   0.000000000647682   0.000000000817668   0.000000000316362   0.000000000531751   0.000000000711352   0.000000000792754   0.000000000412552   0.000000000479690   0.000000000891129
                           0   0.000000000450035  -0.000000000053907  -0.000000000131111   0.000000000249622  -0.000000000321960   0.000000000034445   0.000000000061047  -0.000000000181213   0.000000000080889  -0.000000000234603   0.000000000195323
                           0   0.000000000238779   0.000000001298298   0.000000001829352   0.000000002466212   0.000000002514541  -0.000000001400090   0.000000002954111   0.000000004936017  -0.000000003321569   0.000000003603631   0.000000003426706
                           0  -0.000000001161777   0.000000000387224   0.000000001091879   0.000000000299960   0.000000001130565   0.000000000157621   0.000000000641426   0.000000001606984  -0.000000000411143   0.000000001069539   0.000000001177037
                           0  -0.000000002386782  -0.000000000193391   0.000000000481052  -0.000000000600317   0.000000001049590  -0.000000000991880  -0.000000000024354   0.000000001560591  -0.000000001951549   0.000000000995906   0.000000000542035
                           0   0.000000001547447   0.000000001673456  -0.000000000143294   0.000000002535414   0.000000002188731  -0.000000002716918   0.000000004108827   0.000000001938503  -0.000000002393441   0.000000003745909   0.000000000815394
                           0   0.000000001186029   0.000000000413992   0.000000000405647   0.000000000825416   0.000000000353398   0.000000000002425   0.000000000788287   0.000000001044756  -0.000000000864290   0.000000001091519   0.000000000612508
                           0   0.000000000718661  -0.000000000216304  -0.000000000211091   0.000000000174572  -0.000000000190225  -0.000000000580830   0.000000000254455   0.000000000195760  -0.000000001323939   0.000000000727526  -0.000000000606072
                           0   0.000000001313357   0.000000000060435   0.000000000988231   0.000000000741815  -0.000000000543727   0.000000000930090   0.000000000124308   0.000000000257404  -0.000000000269279   0.000000000518888  -0.000000000933392
                           0  -0.000000000311076   0.000000000087816   0.000000000466908   0.000000000308248   0.000000000288426   0.000000000024029   0.000000000414936   0.000000000545557  -0.000000000321379   0.000000000639208   0.000000000237360
                           0  -0.000000000448380  -0.000000000343686  -0.000000000289619  -0.000000000148524  -0.000000000192010  -0.000000000596193  -0.000000000024486  -0.000000000014686  -0.000000000841139   0.000000000020865  -0.000000000182822
                           0  -0.000000000445693   0.000000000233199   0.000000001098424   0.000000000335043   0.000000000271293   0.000000000668526   0.000000000570618   0.000000000168186   0.000000000265590   0.000000000956884  -0.000000001043876
                           0   0.000000000506521   0.000000000212756   0.000000000106661   0.000000000177528   0.000000000029625   0.000000000454955  -0.000000000020997  -0.000000000053996   0.000000000530105  -0.000000000188813   0.000000000342202
                           0  -0.000000000065234   0.000000000193989   0.000000000619442   0.000000000657532   0.000000000252878   0.000000000181743   0.000000000685701   0.000000000663458   0.000000000161228   0.000000000406395   0.000000000705949
                           0  -0.000000000688690  -0.000000000546765   0.000000000976175   0.000000001347389  -0.000000000191687  -0.000000000712993   0.000000000888842   0.000000001909386  -0.000000001259263  -0.000000000361996   0.000000002603900
                           0  -0.000052133142462  -0.000014880494087   0.000067768547035   0.000093537633088  -0.000004341247979  -0.000027473156889   0.000096064887072   0.000081211287045  -0.000030202820082   0.000012806390701   0.000103259334993
                           0  -0.000052133279764  -0.000014880586391   0.000067768607014   0.000093537823413  -0.000004341364066  -0.000027473405855   0.000096065211233   0.000081211420737  -0.000030203232614   0.000012806693648   0.000103259384567
                           0   0.000022059684758   0.000022002667634   0.000018560555899   0.000014917664229   0.000020535943223   0.000024854432452   0.000014959759777   0.000013530065659   0.000025180743070   0.000021913773163   0.000011033425284
                           0  -0.000109920846060  -0.000045884700731   0.000196387630354   0.000286257969840  -0.000031023860936  -0.000060159482360   0.000259475370004   0.000240869327572  -0.000070589812694  -0.000029347841494   0.000370386988299
                           0  -0.000071146601605  -0.000036022633314   0.000107350826924   0.000161881797158  -0.000027360401547  -0.000044857877759   0.000143381357157   0.000137924152709  -0.000053654143724  -0.000029839707618   0.000219823306948
                           0   0.000060268467700   0.000060019460724   0.000048874406067   0.000037389430725   0.000060634145368   0.000063053607731   0.000039233980290   0.000044361794237   0.000058954224915   0.000064716301770   0.000026600304757
                           0  -0.000140356834546  -0.000024752562787   0.000266446714577   0.000354966586881   0.000042413908573  -0.000094504585193   0.000330690862048   0.000412230349253  -0.000190266983109   0.000079874875408   0.000495293175127
                           0  -0.000079703259898  -0.000034698751891   0.000061266612176   0.000087589459824  -0.000004923099291  -0.000063843990849   0.000077003261594   0.000126285078362  -0.000101911443498  -0.000005971277810   0.000157973301880
                           0   0.000086326230508   0.000078922590610   0.000058644349759   0.000055835547863   0.000072720323627   0.000080039659823   0.000061271296027   0.000039969744291   0.000089239014131   0.000078379272630   0.000026851496274
                           0  -0.000018477822092   0.000032989033313   0.000202466623397   0.000346837241644   0.000077886076456  -0.000116516957044   0.000401229476898   0.000296245902034  -0.000177593321202   0.000270536025236   0.000233735031919
                           0  -0.000056410079802  -0.000043807838312  -0.000011945419918  -0.000002645468071  -0.000033168276795  -0.000053009755918  -0.000009069714954   0.000013497379172  -0.000062335380662  -0.000045782795914   0.000030289289932
                           0   0.000072371944662   0.000069727914595   0.000073358805633   0.000054620494103   0.000059021588531   0.000100691235639   0.000043080839409   0.000046063008259   0.000110701436851   0.000040324251164   0.000065746683672
                           0   0.000079846522959   0.000061972766029   0.000103230920625   0.000222760896237   0.000055851311625  -0.000044540971672   0.000276790208834   0.000102035148337  -0.000033560886808   0.000216562905432   0.000035882969299
                           0  -0.000054856787757  -0.000066804861284  -0.000037208442443  -0.000049493554796  -0.000073445457393  -0.000025977144267  -0.000081353445482  -0.000031062263902  -0.000030246788604  -0.000120200970232   0.000018517395965
                           0   0.000040759382587   0.000049591775111   0.000063862908499   0.000040500775005   0.000050179233515   0.000076174724029   0.000027000052593   0.000059091422779   0.000070853000139   0.000028977288342   0.000071076554949
                           0  -0.000013771569672   0.000020409385527   0.000053706544597   0.000040553098890   0.000029859453050   0.000016043812449   0.000058844947952   0.000026309224577   0.000019840132806   0.000064880902763  -0.000015181486115
                           0  -0.000030181447415  -0.000042247715686  -0.000036979685010  -0.000018360199076  -0.000049189868642  -0.000036906760639  -0.000033169721399  -0.000019147094069  -0.000037838929845  -0.000067948825309   0.000024543094834
                           0   0.000019975356947   0.000021364810328   0.000017989461404   0.000019291797172   0.000023465360193   0.000018436623346   0.000018595207607   0.000025146751568   0.000017941678348   0.000017640961224   0.000028790497296
                           0   0.000000004119720   0.000000000716669  -0.000000000768969   0.000000001630748  -0.000000000476367  -0.000000000059694   0.000000001048082   0.000000000466240  -0.000000000308607  -0.000000000185327   0.000000001838424
                           0   0.000000001189951  -0.000000000821907  -0.000000001046703   0.000000000183365  -0.000000001036329  -0.000000001244789  -0.000000000253959  -0.000000000151489  -0.000000001954328  -0.000000000432815   0.000000000014405
                           0   0.000000005751483   0.000000000912914   0.000000000680470   0.000000001798418  -0.000000001407306   0.000000002717641   0.000000000086584  -0.000000001001341   0.000000002888960  -0.000000000097779  -0.000000001051387
                           0  -0.000000000013605   0.000000000137016  -0.000000000212304  -0.000000000294988   0.000000000404748  -0.000000000277200  -0.000000000237578   0.000000000418553  -0.000000000520598   0.000000000296285  -0.000000000009384
                           0   0.000000000238287   0.000000000317886   0.000000000803144   0.000000000926359   0.000000000173037   0.000000000539960   0.000000000897064   0.000000000509742   0.000000000595827   0.000000000376358   0.000000000846967
                           0  -0.000000000742162  -0.000000000200544   0.000000001846910   0.000000002562308  -0.000000000429192   0.000000000074197   0.000000002653392   0.000000001205548   0.000000000609432  -0.000000000086434   0.000000002252730
                           0  -0.000071146463732  -0.000036022578542   0.000107350151624   0.000161880902445  -0.000027360415730  -0.000044857817831   0.000143380881326   0.000137922966127  -0.000053654234685  -0.000029838250321   0.000219820481550
                           0  -0.000109922361098  -0.000045885787526   0.000196387075754   0.000286257803128  -0.000031025189270  -0.000060161358241   0.000259476889067   0.000240867907353  -0.000070592537193  -0.000029345058824   0.000370383616502
                           0   0.000060268050778   0.000060019326352   0.000048875022565   0.000037390135040   0.000060633994439   0.000063053664231   0.000039234587477   0.000044362234556   0.000058954445554   0.000064716014821   0.000026601428209
                           0  -0.000232254568605  -0.000118475294274   0.000228545884686   0.000418717471863  -0.000020798455233  -0.000287090041089   0.000392625180664   0.000481287491894  -0.000365113200952  -0.000013165408023   0.000586026887341
                           0  -0.000232256759768  -0.000118476803870   0.000228546803063   0.000418719560460  -0.000020800159782  -0.000287092755158   0.000392628485602   0.000481289017079  -0.000365117634911  -0.000013163721941   0.000586029203136
                           0   0.000227331622470   0.000233947189359   0.000226653489027   0.000183441078671   0.000208395237974   0.000290117080165   0.000192813756500   0.000131253831436   0.000305052278846   0.000242925369155   0.000113781737435
                           0  -0.000313985429572  -0.000221258089924   0.000232878492279   0.000559543081006  -0.000159579142012  -0.000447264478277   0.000591430788281   0.000403088823345  -0.000481419381443   0.000048521483366   0.000471087501678
                           0  -0.000214692757212  -0.000161017959335   0.000124358566686   0.000333187680517  -0.000112667182068  -0.000314034630848   0.000338497826156   0.000276213203165  -0.000357653669160  -0.000008629433784   0.000338965351092
                           0   0.000367951766632   0.000390338091388   0.000411201494800   0.000318084235892   0.000368438359049   0.000504255372054   0.000289936799264   0.000323298385597   0.000504182301694   0.000333959250545   0.000356179180292
                           0  -0.000372555965252  -0.000238165250222   0.000326386335171   0.000475381157843  -0.000316413463817  -0.000115623450114   0.000510067729117   0.000032615325547  -0.000055868716411   0.000036778808165   0.000121912722707
                           0  -0.000208771008806  -0.000151751286851   0.000022581743263   0.000127658721141  -0.000091891857509  -0.000261812786020   0.000114919559813   0.000188657383591  -0.000342110501599  -0.000066187742861   0.000238531480415
                           0   0.000381342657247   0.000418391531598   0.000363416472051   0.000312617545470   0.000478452125886   0.000374958505156   0.000289329103654   0.000503257004944   0.000311502355965   0.000368647603223   0.000497030284398
                           0  -0.000249364636401  -0.000100763767263   0.000333226597300   0.000252222032279  -0.000197213083971   0.000216629171557   0.000234162227090  -0.000070172496125   0.000303570370089  -0.000012338162350  -0.000007930844947
                           0  -0.000262430922968  -0.000161262319813  -0.000116118331609  -0.000029984156736  -0.000017059044030  -0.000413781129871   0.000004459693724   0.000212032168463  -0.000574833929313  -0.000018297388943   0.000176622632067
                           0   0.000256642735828   0.000254955301116   0.000173843139006   0.000204379558453   0.000308493956517   0.000133879994787   0.000219061102113   0.000324607385176   0.000084947759398   0.000267507081634   0.000295409909833
                           0   0.000028105872352   0.000025333028592   0.000092018532058   0.000069826185111  -0.000023613908018   0.000128596096031   0.000034994446495  -0.000015085044700   0.000194230852071  -0.000052048662591   0.000074209995904
                           0  -0.000219361216792  -0.000161692039804  -0.000077279861894  -0.000044669605979  -0.000081753775900  -0.000271995705827  -0.000000127941436   0.000056715761751  -0.000422589679719   0.000041616098571  -0.000058590871631
                           0   0.000071267207588   0.000054929643967   0.000047291335146   0.000058702119866   0.000060933545013   0.000032393001594   0.000061214068560   0.000072870725905   0.000004436674861   0.000077368629217   0.000052151280415
                           0  -0.000000004917315  -0.000000001267779   0.000000001464879  -0.000000000770297   0.000000000060305  -0.000000000147927  -0.000000000105344   0.000000000062325  -0.000000000667831   0.000000001130795  -0.000000001743508
                           0  -0.000000003393083  -0.000000001580551  -0.000000000484101  -0.000000001069290  -0.000000001090685  -0.000000001262501  -0.000000000314150  -0.000000001572452  -0.000000001210328  -0.000000000525807  -0.000000002150275
                           0  -0.000000005039081   0.000000001878882   0.000000003011181  -0.000000001384691   0.000000003360329   0.000000003345055  -0.000000000440949   0.000000001213312   0.000000005035355  -0.000000000248522   0.000000002664418
                           0   0.000000000510392   0.000000000199154  -0.000000000190605   0.000000000172371   0.000000000025078  -0.000000000069986   0.000000000411267  -0.000000000453752   0.000000000284650   0.000000000461671  -0.000000000840901
                           0  -0.000000000169379   0.000000000219536   0.000000000815087   0.000000000597230   0.000000000313711   0.000000000433117   0.000000000504210   0.000000000833948   0.000000000336018   0.000000000217089   0.000000001057286
                           0  -0.000000001181165   0.000000000068176   0.000000002998554   0.000000002266804   0.000000000570074   0.000000001092631   0.000000001490118   0.000000003491004  -0.000000000193310   0.000000000027028   0.000000004881868
                           0  -0.000079702017356  -0.000034698312277   0.000061265973535   0.000087589340022  -0.000004923009671  -0.000063843948677   0.000077003871756   0.000126282992843  -0.000101910455745  -0.000005968705013   0.000157967736434
                           0  -0.000140358473191  -0.000024755234986   0.000266446583604   0.000354970326533   0.000042408457886  -0.000094508746792   0.000330699840835   0.000412223097411  -0.000190270102699   0.000079885607647   0.000495276310475
                           0   0.000086326455004   0.000078922941223   0.000058645094338   0.000055835529491   0.000072720718194   0.000080040810017   0.000061270203248   0.000039971161919   0.000089240053375   0.000078377375461   0.000026855284976
                           0  -0.000214689181405  -0.000161015600545   0.000124357729617   0.000333184889115  -0.000112664940257  -0.000314029400623   0.000338491906228   0.000276211844169  -0.000357645231196  -0.000008635296586   0.000338965985241
                           0  -0.000313992248572  -0.000221262059652   0.000232882220530   0.000559548142291  -0.000159584333946  -0.000447268480526   0.000591438353932   0.000403090408357  -0.000481423656358   0.000048520135353   0.000471093101869
                           0   0.000367951060850   0.000390337592500   0.000411201086513   0.000318083591521   0.000368437249822   0.000504255611110   0.000289937515609   0.000323294928429   0.000504182811244   0.000333962423643   0.000356172604840
                           0  -0.000730202808553  -0.000475122024887   0.000255646607024   0.000419767109070  -0.000448609386533  -0.000429105756622   0.000411728253941   0.000179653288230  -0.000462919930978  -0.000228984855811   0.000375881879857
                           0  -0.000730210259957  -0.000475127594526   0.000255650064174   0.000419774577935  -0.000448617870467  -0.000429111754938   0.000411739705005   0.000179651837458  -0.000462926075000  -0.000228984789321   0.000375886688380
                           0   0.000984253560172   0.001009291162612   0.000901938290889   0.000846083774918   0.001058977937371   0.000957153637959   0.000854592797444   0.000993961208167   0.000923156292420   0.001002173458855   0.000891920294940
                           0  -0.001028542150908  -0.000550321183868   0.000427291265845   0.000267858269568  -0.000528067705504  -0.000145984935646   0.000238610600787   0.000058093103261  -0.000237664108412  -0.000267938020890   0.000235049677873
                           0  -0.000350618520284  -0.000256116528030   0.000221300187326   0.000479351766746  -0.000229227842510  -0.000375186267570   0.000494469620545   0.000285321319473  -0.000411440313710  -0.000000119929108   0.000373555254031
                           0   0.001470619833199   0.001104636822687   0.000693898736972   0.001047526860664   0.001075689292505   0.000716781514208   0.001067348134625   0.001000167595101   0.000812974168001   0.001040017922629   0.000925767681309
                           0  -0.000739010810809  -0.000297379401152   0.000422698212367   0.000083815318133  -0.000266725192194   0.000182696909993   0.000045910723911   0.000033459295343   0.000111147128953  -0.000180182407083   0.000141912145545
                           0   0.000341476077407  -0.000144384446396  -0.000263972142391   0.000477441506175  -0.000243697050311  -0.000730809195944   0.000530621101643   0.000080438359179  -0.000684261310076   0.000141136220826   0.000070888188360
                           0   0.000848851155129   0.000491661379216   0.000197798078663   0.000529519312221   0.000424787032408   0.000187809897933   0.000513457751721   0.000439230784281   0.000216506219408   0.000486023769847   0.000421505878815
                           0  -0.000315899857677  -0.000087448995876   0.000186636779376  -0.000046962606719  -0.000039128541539   0.000147586900072  -0.000079253033988   0.000079821167799   0.000060494258663  -0.000074204996292   0.000119271821811
                           0  -0.000069229015239  -0.000168350369776  -0.000292248003971   0.000191210108860  -0.000164195228147  -0.000736053796802   0.000421410361734  -0.000218969274228  -0.000574868866757   0.000261918607183  -0.000518016553165
                           0   0.000019055745072   0.000066063649028   0.000061180234495   0.000078123909414   0.000089902568067  -0.000014856231570   0.000113042413670   0.000064115561041   0.000004555749515   0.000134184083246  -0.000007299432331
                           0   0.000000004027663   0.000000000926983  -0.000000001485763   0.000000001165315  -0.000000000066789  -0.000000001293682   0.000000002178932  -0.000000001012312  -0.000000000245357   0.000000000668062  -0.000000001034392
                           0   0.000000002028710  -0.000000000719055  -0.000000001270895   0.000000000357866  -0.000000001211031  -0.000000001590041  -0.000000000374490  -0.000000001138610  -0.000000001129707  -0.000000001151644  -0.000000001349571
                           0   0.000000012696670   0.000000004744569   0.000000001094580   0.000000001283805   0.000000001192398   0.000000008752109  -0.000000004588386   0.000000003693373   0.000000008360643  -0.000000005618661   0.000000010978480
                           0   0.000000000398095  -0.000000000035616  -0.000000000103600   0.000000000222254  -0.000000000275744   0.000000000045551   0.000000000056729  -0.000000000154902   0.000000000094094  -0.000000000200940   0.000000000176244
                           0   0.000000000503728   0.000000000362198   0.000000000549320   0.000000000703084   0.000000000272216   0.000000000460324   0.000000000605374   0.000000000673845   0.000000000367738   0.000000000397156   0.000000000766690
                           0   0.000000000200133   0.000000001109388   0.000000001560929   0.000000002136849   0.000000002199061  -0.000000001231550   0.000000002535541   0.000000004284685  -0.000000002892526   0.000000003071160   0.000000003007511
                           0  -0.000056409373606  -0.000043806539263  -0.000011946289937  -0.000002647380273  -0.000033165622877  -0.000053008984190  -0.000009073163966   0.000013499937485  -0.000062334867875  -0.000045785525933   0.000030293884365
                           0  -0.000018482863567   0.000032985390965   0.000202469509601   0.000346842313998   0.000077876262576  -0.000116516485832   0.000401242381913   0.000296228228159  -0.000177582175588   0.000270541222248   0.000233710911136
                           0   0.000072370864345   0.000069727559399   0.000073358328702   0.000054619633332   0.000059022663085   0.000100689891781   0.000043078773011   0.000046066752135   0.000110698075386   0.000040322601452   0.000065752503701
                           0  -0.000208762184066  -0.000151747138593   0.000022577972100   0.000127655021250  -0.000091887005728  -0.000261808969102   0.000114912829739   0.000188655883633  -0.000342104918241  -0.000066187120538   0.000238524553078
                           0  -0.000372566598750  -0.000238171772967   0.000326392274088   0.000475386071860  -0.000316421324340  -0.000115625735784   0.000510070346694   0.000032624238680  -0.000055875496782   0.000036763841299   0.000121943290434
                           0   0.000381344177477   0.000418391696094   0.000363415900313   0.000312618257644   0.000478449864548   0.000374959701609   0.000289332928802   0.000503247585851   0.000311508250072   0.000368654316915   0.000497012451539
                           0  -0.000350610755167  -0.000256110637842   0.000221295347333   0.000479343886387  -0.000229219685030  -0.000375180086950   0.000494460464774   0.000285315587919  -0.000411427560491  -0.000000120224154   0.000373539270715
                           0  -0.001028554915819  -0.000550327922291   0.000427296224487   0.000267863236522  -0.000528072908014  -0.000145993529709   0.000238617343069   0.000058104780754  -0.000237683676772  -0.000267936862685   0.000235070176760
                           0   0.001470611217849   0.001104632707748   0.000693906423763   0.001047524592235   0.001075676450505   0.000716799620765   0.001067345808230   0.001000145180322   0.000813005369851   0.001040006864589   0.000925748090460
                           0  -0.001220550545600  -0.000556319749463   0.000640859892558   0.000390661391071  -0.000498378624552  -0.000044607047133   0.000354664808713   0.000186635143855  -0.000127010364886  -0.000282754838388   0.000424381005517
                           0  -0.001220575809245  -0.000556329653188   0.000640871348066   0.000390659904003  -0.000498388390841  -0.000044605586105   0.000354668041238   0.000186637533951  -0.000127017113051  -0.000282754507340   0.000424386385349
                           0   0.000411166670986   0.000783697222317   0.001185239677846   0.000889450744739   0.000827448424880   0.001098578681820   0.000830615634353   0.000976514852226   0.001102989219811   0.000660127796466   0.001113644474382
                           0  -0.001313045571826  -0.000540854242085   0.000548418271605   0.000032140743339  -0.000415960701738   0.000082411914912  -0.000011536945742   0.000109207729228  -0.000119492305838  -0.000268809947241   0.000211948369293
                           0  -0.002068177791678  -0.000822340156348   0.000747439496448   0.000021281705425  -0.000582212161814  -0.000067318140133   0.000066914462630   0.000140322634846  -0.000325772028080  -0.000327639870798   0.000223353377711
                           0  -0.000751415296022   0.000127607466333   0.000768999196399   0.000117459008166   0.000403802432488   0.000481301267652   0.000220139611625   0.000561188192007   0.000287422057743   0.000367059430167   0.000432439146705
                           0  -0.000130799483283  -0.000119365530666   0.000061530611769   0.000055589334225  -0.000149480012742  -0.000037330865531   0.000071123999838  -0.000081561375555  -0.000007114233828  -0.000051706091545  -0.000056072901443
                           0   0.000868596959904  -0.000133983144994  -0.000407823419973   0.000552987241551  -0.000656597624705  -0.000412211969981   0.000482157290291  -0.000631181374615   0.000012443515669  -0.000210876737170  -0.000303628126030
                           0   0.000299758732136   0.000102468973535  -0.000003994192814   0.000143676333971   0.000015118203051   0.000015975699944   0.000151092142883  -0.000017079485663   0.000093520141584   0.000092625373901   0.000006520557012
                           0   0.000000003010370   0.000000000659868  -0.000000000887814   0.000000001476940  -0.000000000222353   0.000000000358016  -0.000000000973237   0.000000000458497   0.000000000360504  -0.000000000894429   0.000000001830147
                           0  -0.000000006170438  -0.000000001398975  -0.000000001119254  -0.000000001192418  -0.000000001034834  -0.000000001621645  -0.000000000291315  -0.000000002244652  -0.000000000319113  -0.000000000738882  -0.000000001273952
                           0  -0.000000033248418  -0.000000003720722   0.000000014892921  -0.000000014419288   0.000000007576141   0.000000011123418  -0.000000015173141   0.000000014550634  -0.000000001747254   0.000000000848992   0.000000010674591
                           0  -0.000000002061560  -0.000000000187844   0.000000000397889  -0.000000000528937   0.000000000907490  -0.000000000888210  -0.000000000028537   0.000000001352394  -0.000000001740225   0.000000000855709   0.000000000458546
                           0  -0.000000001011195   0.000000000337390   0.000000000968679   0.000000000276874   0.000000001003624   0.000000000139703   0.000000000572728   0.000000001422380  -0.000000000375309   0.000000000954576   0.000000001029977
                           0   0.000000001314093   0.000000001463783  -0.000000000069406   0.000000002213677   0.000000001934569  -0.000000002308419   0.000000003569752   0.000000001685314  -0.000000002054642   0.000000003278008   0.000000000639472
                           0  -0.000054853633870  -0.000066802052008  -0.000037208117547  -0.000049496719137  -0.000073439303157  -0.000025976330217  -0.000081358885257  -0.000031054505947  -0.000030253250321  -0.000120195065336   0.000018518216167
                           0   0.000079845239087   0.000061967816887   0.000103231559111   0.000222766840070   0.000055838974950  -0.000044538172345   0.000276796194003   0.000102023264050  -0.000033547505513   0.000216547410960   0.000035888107735
                           0   0.000040761340709   0.000049593519746   0.000063865140587   0.000040501029153   0.000050180887043   0.000076177191993   0.000026999757523   0.000059093450219   0.000070853583826   0.000028980768016   0.000071075999476
                           0  -0.000262416177555  -0.000161253393844  -0.000116126231689  -0.000029985621306  -0.000017048804268  -0.000413781375509   0.000004457391867   0.000212028605816  -0.000574820623538  -0.000018300292609   0.000176616021068
                           0  -0.000249386194382  -0.000100773205766   0.000333234792628   0.000252221021908  -0.000197220478271   0.000216627097892   0.000234163346652  -0.000070164239536   0.000303551235888  -0.000012332828232  -0.000007922199299
                           0   0.000256645702480   0.000254958482243   0.000173843008456   0.000204380095284   0.000308494517808   0.000133884714555   0.000219061431478   0.000324601993860   0.000084962227640   0.000267502107466   0.000295408010745
                           0   0.000341497857464  -0.000144375822981  -0.000263971192014   0.000477433686715  -0.000243692226880  -0.000730782575538   0.000530591899687   0.000080446113720  -0.000684231588361   0.000141102321375   0.000070922298796
                           0  -0.000739005281359  -0.000297381514428   0.000422693884764   0.000083825324700  -0.000266727794267   0.000182680245919   0.000045929190393   0.000033456753835   0.000111129380378  -0.000180164889566   0.000141897304276
                           0   0.000848845544083   0.000491660496984   0.000197813150790   0.000529510736996   0.000424781404220   0.000187840350574   0.000513433938391   0.000439235487302   0.000216535445177   0.000485992909260   0.000421536825985
                           0  -0.002068220717820  -0.000822337625078   0.000747446632162   0.000021250804378  -0.000582184101802  -0.000067320189844   0.000066889939302   0.000140355694520  -0.000325799803386  -0.000327623174035   0.000223366671686
                           0  -0.001313085347851  -0.000540860307650   0.000548427571506   0.000032131314437  -0.000415957919202   0.000082409853908  -0.000011538485131   0.000109213763027  -0.000119498214079  -0.000268808344863   0.000211956094953
                           0  -0.000751507181396   0.000127596840591   0.000769025187691   0.000117417199290   0.000403815598975   0.000481315733460   0.000220108388489   0.000561214926165   0.000287410525016   0.000367060227226   0.000432458214563
                           0  -0.004279989160945  -0.001138648751388   0.001116125829244  -0.000797006978435  -0.000188170004658   0.000007352380514  -0.000279606535398   0.000290803476830  -0.000424365938614  -0.000205777224375   0.000026380136432
                           0  -0.004280024676696  -0.001138656695727   0.001116135457576  -0.000797017899456  -0.000188173639559   0.000007359204420  -0.000279614575708   0.000290808111506  -0.000424367388491  -0.000205783276240   0.000026391343608
                           0  -0.002231981170559  -0.000199334360297   0.000705946816050  -0.000340763336163   0.000411058654518   0.000244089182673   0.000079502772083   0.000383557933802   0.000110130567647   0.000246074283866   0.000189827138845
                           0   0.000576265609339  -0.000097801593304  -0.000078200205741   0.000291689932442  -0.000387550451189   0.000030651967979   0.000074491373160  -0.000190260934931   0.000097221124597  -0.000281176196166   0.000095028862530
                           0   0.000570617939153  -0.000217110809553  -0.000115833484470   0.000397523770427  -0.000602030621013  -0.000003828893711   0.000106092418591  -0.000294665923212   0.000089349729220  -0.000444758302794   0.000138497634774
                           0   0.000415388760822   0.000073222789886   0.000024477259759   0.000138675039456  -0.000034795385207   0.000080625025877   0.000070121702676   0.000017441731647   0.000095234496075  -0.000001570388326   0.000078801086700
                           0  -0.000000038346503  -0.000000006021505   0.000000009575580  -0.000000013184860   0.000000004742461   0.000000000187133  -0.000000004589603   0.000000005828588  -0.000000005133473   0.000000003542772  -0.000000001602459
                           0   0.000000014710454   0.000000002566932  -0.000000005888223   0.000000005535193  -0.000000005228080  -0.000000001039251   0.000000002167757  -0.000000004629742   0.000000001736653  -0.000000003720484   0.000000000507628
                           0  -0.000000117505457  -0.000000009865563   0.000000017966932  -0.000000032987114   0.000000015674256  -0.000000003919543  -0.000000004576123   0.000000009226618  -0.000000008530428   0.000000010543600  -0.000000005034962
                           0   0.000000000682288  -0.000000000139017  -0.000000000143898   0.000000000171139  -0.000000000143379  -0.000000000425221   0.000000000224069   0.000000000172632  -0.000000001036540   0.000000000622971  -0.000000000496738
                           0   0.000000001061385   0.000000000348816   0.000000000291236   0.000000000677186   0.000000000277712   0.000000000000212   0.000000000627386   0.000000000835083  -0.000000000705070   0.000000000855847   0.000000000502013
                           0   0.000000001129397   0.000000000008184   0.000000000726920   0.000000000596992  -0.000000000506053   0.000000000711600   0.000000000033010   0.000000000210235  -0.000000000277173   0.000000000315259  -0.000000000655933
                           0  -0.000030188558469  -0.000042248169740  -0.000036984525114  -0.000018364566716  -0.000049184397221  -0.000036916957629  -0.000033168061040  -0.000019145051559  -0.000037848361446  -0.000067943898069   0.000024540262050
                           0  -0.000013770280036   0.000020409565043   0.000053712606760   0.000040554771599   0.000029855758333   0.000016053731796   0.000058841600784   0.000026308675857   0.000019848094397   0.000064877644556  -0.000015180587085
                           0   0.000019970333995   0.000021363147877   0.000017986130827   0.000019289840004   0.000023466336966   0.000018430451631   0.000018595830606   0.000025147234435   0.000017935725338   0.000017641251403   0.000028790662565
                           0  -0.000219348840412  -0.000161695001277  -0.000077293577866  -0.000044666749815  -0.000081754518396  -0.000272007499060  -0.000000130352572   0.000056720336395  -0.000422608979171   0.000041610775930  -0.000058576155423
                           0   0.000028105687867   0.000025335395484   0.000092022714730   0.000069826576649  -0.000023613785036   0.000128598901858   0.000034998585966  -0.000015089449687   0.000194240407544  -0.000052045114106   0.000074199643083
                           0   0.000071270231451   0.000054926268162   0.000047288725564   0.000058703437965   0.000060929576517   0.000032390144492   0.000061213074865   0.000072869958877   0.000004429391329   0.000077367067187   0.000052151688760
                           0  -0.000069244571943  -0.000168356487279  -0.000292261357680   0.000191201673028  -0.000164173064373  -0.000736098372927   0.000421414214969  -0.000218928288302  -0.000574961195934   0.000261962826193  -0.000518028173540
                           0  -0.000315896865221  -0.000087448492164   0.000186638556959  -0.000046958720240  -0.000039134307105   0.000147594310264  -0.000079252500934   0.000079812469195   0.000060511264940  -0.000074214640225   0.000119276120246
                           0   0.000019039282457   0.000066057603893   0.000061178191286   0.000078119919731   0.000089906176687  -0.000014873558226   0.000113047052765   0.000064120871016   0.000004528469816   0.000134197113448  -0.000007311892333
                           0   0.000868780127018  -0.000133937651735  -0.000407926466261   0.000553061276131  -0.000656572442194  -0.000412329273984   0.000482270219932  -0.000631239118602   0.000012397361958  -0.000210781809277  -0.000303766379810
                           0  -0.000130742956529  -0.000119355426795   0.000061509627497   0.000055608759462  -0.000149478076202  -0.000037350834491   0.000071146382060  -0.000081571431258  -0.000007124066697  -0.000051686871653  -0.000056098086190
                           0   0.000299799914473   0.000102479783355  -0.000004022174614   0.000143694093123   0.000015119709595   0.000015945426801   0.000151120611043  -0.000017101930359   0.000093514551088   0.000092643489142   0.000006485308170
                           0   0.000571041548538  -0.000217050902545  -0.000115939192149   0.000397718963474  -0.000602082553136  -0.000003856983324   0.000106186480892  -0.000294771383624   0.000089419515294  -0.000444793355097   0.000138492845978
                           0   0.000576528248678  -0.000097765176576  -0.000078261168060   0.000291807124669  -0.000387582498512   0.000030635094005   0.000074549488466  -0.000190323510029   0.000097262820671  -0.000281194763217   0.000095022701736
                           0   0.000415589232134   0.000073242839022   0.000024445552273   0.000138732141911  -0.000034821736045   0.000080625113628   0.000070138951243   0.000017413702969   0.000095251062313  -0.000001587070491   0.000078803936479
                           0  -0.000165033605329  -0.000136390683507   0.000067042253452   0.000167259839317  -0.000117179522243   0.000005327009077  -0.000020705439017  -0.000016142107530  -0.000012974114696  -0.000152754011800   0.000129870845591
                           0  -0.000165016040750  -0.000136387916682   0.000067038995452   0.000167271849062  -0.000117182022367   0.000005328703847  -0.000020703541018  -0.000016145306172  -0.000012969132363  -0.000152758698629   0.000129876975494
                           0  -0.000135932271241  -0.000011977546484   0.000057304884958  -0.000011341829866   0.000030599707282   0.000020255511422   0.000011959382884   0.000032250360765   0.000014039199645   0.000007996226990   0.000023903243092
                           0   0.000000009574457   0.000000001668979  -0.000000003948751  -0.000000000988715  -0.000000001753555  -0.000000000917298   0.000000001440291  -0.000000002518037   0.000000000900506   0.000000000032718  -0.000000002950993
                           0   0.000000002293549  -0.000000001594523  -0.000000000528150   0.000000002573097  -0.000000000455032  -0.000000000735861  -0.000000000539537  -0.000000000387438  -0.000000000568141  -0.000000001216079   0.000000000594523
                           0   0.000000067972369   0.000000012166429  -0.000000014802309   0.000000009339807  -0.000000005576139   0.000000004334761   0.000000000988967  -0.000000002506873   0.000000004698040  -0.000000000074367  -0.000000001966638
                           0  -0.000000000519891  -0.000000000389007  -0.000000000324721  -0.000000000166286  -0.000000000212706  -0.000000000667286  -0.000000000029665  -0.000000000016742  -0.000000000943650   0.000000000020406  -0.000000000204176
                           0  -0.000000000367588   0.000000000092915   0.000000000521579   0.000000000343897   0.000000000317920   0.000000000025365   0.000000000461635   0.000000000610302  -0.000000000361322   0.000000000709730   0.000000000265921
                           0  -0.000000000413256   0.000000000284809   0.000000001200396   0.000000000386236   0.000000000297158   0.000000000753259   0.000000000646309   0.000000000174186   0.000000000313310   0.000000001076633  -0.000000001181851
                           0   0.000000002340154  -0.000000001766198  -0.000000002223766   0.000000000297002  -0.000000001891288  -0.000000002680882  -0.000000000527700  -0.000000000288748  -0.000000004226089  -0.000000000823351  -0.000000000069650
                           0   0.000000008261332   0.000000001505947  -0.000000001327739   0.000000003297567  -0.000000000749428  -0.000000000082365   0.000000002279108   0.000000001194528  -0.000000000748454  -0.000000000056187   0.000000003767830
                           0   0.000000010815156   0.000000001785434   0.000000002054337   0.000000003566255  -0.000000002391332   0.000000005686169   0.000000000325851  -0.000000001811109   0.000000005718465   0.000000000206340  -0.000000002513816
                           0  -0.000000006948014  -0.000000003143909  -0.000000000912044  -0.000000002053287  -0.000000001892051  -0.000000002373763  -0.000000000650412  -0.000000003136034  -0.000000002259455  -0.000000001063304  -0.000000004272061
                           0  -0.000000010022823  -0.000000002602795   0.000000002839885  -0.000000001555851   0.000000000066814  -0.000000000313984  -0.000000000301815   0.000000000009862  -0.000000001272618   0.000000002115526  -0.000000003528060
                           0  -0.000000009259184   0.000000003938319   0.000000005519877  -0.000000002649037   0.000000005883631   0.000000006403386  -0.000000000834409   0.000000002220380   0.000000010048451  -0.000000000659345   0.000000005463905
                           0   0.000000004485674  -0.000000001377421  -0.000000002569469   0.000000000691846  -0.000000002147806  -0.000000003135742  -0.000000000746612  -0.000000002247312  -0.000000002289591  -0.000000002245358  -0.000000002724753
                           0   0.000000008495353   0.000000001955889  -0.000000002930031   0.000000002297937  -0.000000000100587  -0.000000002515943   0.000000004421238  -0.000000001960783  -0.000000000481729   0.000000001436623  -0.000000002041327
                           0   0.000000023987365   0.000000009098004   0.000000002841627   0.000000002335849   0.000000002133737   0.000000017289741  -0.000000009312652   0.000000007625645   0.000000016331530  -0.000000011328954   0.000000022066273
                           0  -0.000000013269014  -0.000000002968863  -0.000000002224740  -0.000000002328427  -0.000000001817065  -0.000000003207246  -0.000000000645034  -0.000000004503765  -0.000000000667279  -0.000000001544530  -0.000000002555688
                           0   0.000000005086213   0.000000001126867  -0.000000001793291   0.000000002831819  -0.000000000411845   0.000000000665304  -0.000000002032839   0.000000000881611   0.000000000647584  -0.000000001886115   0.000000003625819
                           0  -0.000000063735529  -0.000000006616592   0.000000028644480  -0.000000027632205   0.000000013373711   0.000000021705062  -0.000000029846452   0.000000028498925  -0.000000002913638   0.000000001829088   0.000000021067891
                           0   0.000000031370917   0.000000005516393  -0.000000011788447   0.000000010776136  -0.000000009236710  -0.000000001818510   0.000000004321238  -0.000000009099112   0.000000003446225  -0.000000007196431   0.000000000950175
                           0  -0.000000074730620  -0.000000011648999   0.000000019159389  -0.000000025540133   0.000000008429277   0.000000000314654  -0.000000008906391   0.000000011578361  -0.000000009871648   0.000000007157240  -0.000000003075982
                           0  -0.000000240963011  -0.000000021502764   0.000000038302931  -0.000000064831115   0.000000027864998  -0.000000008251880  -0.000000009440794   0.000000018959707  -0.000000017283311   0.000000020137670  -0.000000008862689
                           0   0.000000000001953  -0.000000004089903  -0.000000001042710   0.000000004898522  -0.000000000830641  -0.000000001670029  -0.000000001350416  -0.000000000870992  -0.000000001446295  -0.000000002781300   0.000000001121209
                           0   0.000000014534406   0.000000002420876  -0.000000007890222  -0.000000002027673  -0.000000003109365  -0.000000002028776   0.000000002583855  -0.000000005126418   0.000000001426967  -0.000000000291136  -0.000000005967361
                           0   0.000000149386930   0.000000028423664  -0.000000035004940   0.000000019921094  -0.000000010049311   0.000000008811711   0.000000003563827  -0.000000006992126   0.000000011045200   0.000000001476059  -0.000000006137709
                           0  -0.000000009005869  -0.000000001775478   0.000000000018576  -0.000000000209778  -0.000000000053060  -0.000000000506363  -0.000000000506969  -0.000000000217818  -0.000000000658803  -0.000000000714527  -0.000000000104399
                           0  -0.000000009008647  -0.000000001774220   0.000000000022056  -0.000000000211311  -0.000000000051664  -0.000000000504649  -0.000000000505112  -0.000000000215938  -0.000000000657343  -0.000000000711614  -0.000000000104441
                           0   0.000000025896293   0.000000007896706  -0.000000010397339   0.000000003702231  -0.000000000412300   0.000000000174161   0.000000003443039  -0.000000004153756   0.000000003818125   0.000000002968608  -0.000000004129260];
                                       
% Define the expected solution in terms of the residual history
expSolResHistory = [   0.153950888859930   0.097103235586894   0.116687053907327   0.086706117154047   0.106111267371776   0.070843561915674   0.091450156357119   0.048445868524091   0.081430523021844   0.062612903025730   0.067998122128144
                       0.089299302574199   0.116732007974697   0.041656881457333   0.021551087581737   0.163714161422514   0.014933777847327   0.030638082565578   0.020306919206161   0.015501873243391   0.021743252244508   0.025105782017327
                       0.012521715393316   0.009670774203180   0.001502268101625   0.008753333470318   0.015717652919136   0.000238409378933   0.000354806890628   0.000452619988270   0.000094511890667   0.000264607476444   0.000591809869796
                       0.000753277511102   0.014568482892764   0.000121317016590   0.000039803030633   0.010436737195270   0.000003429763795   0.000000534849366   0.000001468467015   0.000000073155559   0.000000333173099   0.000026713035491
                       0.000010370130424   0.000193162609606   0.000000004109044   0.000000127913297   0.000109858110338   0.000000000005398   0.000000000000678   0.000000000010829   0.000000000000033   0.000000000000212   0.000000000240643
                       0.000000001328277   0.000001648782253   0.000000000000032   0.000000000000041   0.000000291046112                   0                   0                   0                   0                   0                   0
                       0.000000000000046   0.000000000001051                   0                   0   0.000000000000072                   0                   0                   0                   0                   0                   0];
                   
% Define the expected solution in terms of the minimum element area size
expSolMinElArea = 1.793548690011981e-04;

%% 9. Define the nonlinear analysis parameters

% number of load steps for the non-linear analysis
propNLinearAnalysis.method = 'newtonRapshon';

% number of load steps for the non-linear analysis
propNLinearAnalysis.noLoadSteps = 1;

% Assign a tolerance for the Newton iterations
propNLinearAnalysis.eps = 1e-9;

% Assign the maximum number of iterations
propNLinearAnalysis.maxIter = 7;

%% 10. Define transient analysis properties

% The Rayleigh parameters adjusted through experiments for this case
alphaR = 17.4670;
betaR = 1.8875e-04;

% Time dependence
propStrDynamics.timeDependence = 'transient';

% Time integration scheme
propStrDynamics.method = 'bossak'; % 'bossak', 'explicitEuler'
propStrDynamics.alphaB = 0; % -.1
propStrDynamics.betaB = .25; % .5
propStrDynamics.gammaB = .5; % .6
propStrDynamics.damping.method = 'rayleigh';
propStrDynamics.damping.computeDampMtx = @computeDampMtxRayleigh;
propStrDynamics.damping.alpha = alphaR;
propStrDynamics.damping.beta = betaR;

% Function handle to the computation of the matrices for the defined time
% integration scheme
if strcmp(propStrDynamics.method,'explicitEuler')
    propStrDynamics.computeProblemMtrcsTransient = ...
        @computeProblemMtrcsExplicitEuler;
elseif strcmp(propStrDynamics.method,'bossak')
    propStrDynamics.computeProblemMtrcsTransient = ...
        @computeProblemMtrcsBossak;
else
    error('Choose a time integration scheme');
end

% Function handle to the update of the discrete fields for the defined time
% integration scheme
if strcmp(propStrDynamics.method,'explicitEuler')
    propStrDynamics.computeUpdatedVct = ...
        @computeBETITransientUpdatedVctAccelerationField;
elseif strcmp(propStrDynamics.method,'bossak')
    propStrDynamics.computeUpdatedVct = ...
        @computeBossakTransientUpdatedVctAccelerationField;
else
    error('Choose a time integration scheme');
end

% Define function handle to the computation of the initial conditions
computeInitCnds = @computeNullInitCndsIGAThinStructure;

% Starting time of the simulation
TStart = 0;
propStrDynamics.TStart = TStart;

% End time of the simulation
TEnd = 0.1;
propStrDynamics.TEnd = TEnd;

% Number of time steps
timeStepScaling = 100;
propStrDynamics.noTimeSteps = timeStepScaling*(propStrDynamics.TEnd - propStrDynamics.TStart);

% Time step size
propStrDynamics.dt = (propStrDynamics.TEnd - propStrDynamics.TStart)/propStrDynamics.noTimeSteps;

%% 11. Solve the transient nonlinear problem
pathToOutput = 'undefined';
[dHatHistory, resHistory, ~, ~] = ...
    solve_IGAMembraneTransient...
    (BSplinePatches, computeInitCnds, propNLinearAnalysis, ...
    propStrDynamics, propPostproc, solve_LinearSystem, propOutput, ...
    pathToOutput, caseName, propEmpireCoSimulation, '');

%% 12. Verify the solution
testCase.verifyEqual(dHatHistory, expSolDispHistory, 'AbsTol', absTol);
testCase.verifyEqual(resHistory, expSolResHistory, 'AbsTol', absTol);
testCase.verifyEqual(BSplinePatch.minElArea,expSolMinElArea, 'AbsTol', absTol);

end
